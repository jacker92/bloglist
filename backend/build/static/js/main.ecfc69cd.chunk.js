(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{19:function(e,t,n){e.exports=n(43)},42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r,a=n(0),c=n.n(a),u=n(17),o=n.n(u),l=n(18),i=n(1),s=n.n(i),p=n(2),f=n(3),m=n(5),b=n.n(m),v=function(){var e=Object(p.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(p.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/blogs",t,{headers:{Authorization:"Bearer ".concat(r.token)}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(p.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.delete("".concat("/api/blogs","/").concat(t.id),{headers:{Authorization:"Bearer ".concat(r.token)}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E={getAll:v,setToken:function(e){r=e},create:d,update:function(){var e=Object(p.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.put("".concat("/api/blogs","/").concat(t.id),t,{headers:{Authorization:"Bearer ".concat(r.token)}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:g},h={getByUserName:function(){var e=Object(p.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/api/users");case 2:return n=e.sent,e.abrupt("return",n.data.find((function(e){return e.username===t})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},k={login:function(){var e=Object(p.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",{username:t,password:n});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},w=function(e){var t=e.login,n=e.setNotification,r=Object(a.useState)(""),u=Object(f.a)(r,2),o=u[0],l=u[1],i=Object(a.useState)(""),m=Object(f.a)(i,2),b=m[0],v=m[1],d=function(){var e=Object(p.a)(s.a.mark((function e(r){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,k.login(o,b);case 4:a=e.sent,t(a),window.localStorage.setItem("token",JSON.stringify(a)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n(e.t0.response.data.error,"error");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement("div",null,c.a.createElement("h2",null,"Log in to application"),c.a.createElement("form",{className:"login",onSubmit:d},c.a.createElement("table",null,c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("p",null,"Username:")),c.a.createElement("td",null,c.a.createElement("input",{type:"text",name:"username",onChange:function(e){var t=e.target;return l(t.value)}}))),c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("p",null,"Password:")),c.a.createElement("td",null,c.a.createElement("input",{type:"password",name:"password",onChange:function(e){var t=e.target;return v(t.value)}}))))),c.a.createElement("input",{id:"login-button",type:"submit",value:"Submit"})))},O=function(e){var t=e.blog,n=e.setLike,r=e.user,u=e.removeBlog,o=Object(a.useState)(!1),l=Object(f.a)(o,2),i=l[0],s=l[1],p=function(e){e.target.style.color="#4e5951"},m=function(e){e.target.style.color="black"};return i?c.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5}},c.a.createElement("p",{onMouseEnter:p,onMouseLeave:m,onClick:function(){return s(!i)}},c.a.createElement("b",null,t.title)),t.url,c.a.createElement("br",null),"likes ",t.likes,c.a.createElement("button",{onClick:function(){return n(t)}},"Like"),c.a.createElement("br",null),t.author,c.a.createElement("br",null),function(){if(r&&t.user&&r.id.toString()===t.user.toString())return c.a.createElement("button",{onClick:function(){return u(t)}},"Remove blog")}()):c.a.createElement("div",{className:"blog"},c.a.createElement("p",{onMouseEnter:p,onMouseLeave:m,onClick:function(){return s(!i)}},t.title," ",t.author))},j=function(e){var t=e.user,n=e.blogs,r=e.logout,a=e.setLike,u=e.removeBlog;return c.a.createElement("div",{id:"blogs"},c.a.createElement("p",null,c.a.createElement("b",null,t.username)," has logged in"),c.a.createElement("button",{onClick:r},"Logout"),n.sort((function(e,t){return e.likes<t.likes?1:e.likes>t.likes?-1:0})).map((function(e){return c.a.createElement(O,{key:e.id,blog:e,setLike:a,user:t,removeBlog:u})})))},y=function(e){var t=e.createNew,n=Object(a.useState)(),r=Object(f.a)(n,2),u=r[0],o=r[1],l=Object(a.useState)(),i=Object(f.a)(l,2),s=i[0],p=i[1],m=Object(a.useState)(),b=Object(f.a)(m,2),v=b[0],d=b[1],g=Object(a.useRef)(),E=Object(a.useRef)(),h=Object(a.useRef)();return c.a.createElement("div",null,c.a.createElement("h2",null,"Create new"),c.a.createElement("form",{onSubmit:function(e){t(e,{title:u,author:s,url:v}),g.current.value="",E.current.value="",h.current.value=""}},"title:",c.a.createElement("input",{id:"title",type:"text",onChange:function(e){return o(e.target.value)},ref:g}),"author:",c.a.createElement("input",{id:"author",type:"text",onChange:function(e){return p(e.target.value)},ref:E}),"url:",c.a.createElement("input",{id:"url",type:"text",onChange:function(e){return d(e.target.value)},ref:h}),c.a.createElement("input",{type:"submit"})))},x=c.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),r=Object(f.a)(n,2),u=r[0],o=r[1],l={display:u?"none":""},i={display:u?"":"none"},s=function(){o(!u)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),c.a.createElement("div",null,c.a.createElement("div",{style:l},c.a.createElement("button",{onClick:s},e.buttonLabel)),c.a.createElement("div",{style:i},e.children,c.a.createElement("button",{onClick:s},"cancel")))}));x.displayName="Togglable";var S=x,C=(n(42),function(e){var t=e.message,n=e.type;if(!t)return null;var r="error"===n?"error":"success";return c.a.createElement("div",{className:r},t)}),B=function(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),n=t[0],r=t[1],u=Object(a.useState)(),o=Object(f.a)(u,2),i=o[0],m=o[1],b=Object(a.useState)(),v=Object(f.a)(b,2),d=v[0],g=v[1],k=Object(a.useState)(),O=Object(f.a)(k,2),x=O[0],B=O[1],N=Object(a.useRef)();Object(a.useEffect)((function(){A(),L()}),[]);var L=function(){var e=Object(p.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAll();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(p.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Remove blog ".concat(t.title))){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,E.remove(t);case 5:r(n.filter((function(e){return e.id!==t.id}))),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),alert(e.t0),M(e.t0.response.data.error,"error");case 13:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(p.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=window.localStorage.getItem("token"))){e.next=8;break}return n=JSON.parse(t),E.setToken(n),e.next=6,h.getByUserName(n.username);case 6:r=e.sent,m(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(p.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E.setToken(t),e.next=3,h.getByUserName(t.username);case 3:n=e.sent,m(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(p.a)(s.a.mark((function e(t,a){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return alert(a),t.preventDefault(),e.prev=2,e.next=5,E.create(a);case 5:c=e.sent,M("A new blog ".concat(c.title," by ").concat(c.author," added"),"success"),N.current&&N.current.toggleVisibility(),r(n.concat(c)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),M(e.t0.response.data.error,"error");case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n){return e.apply(this,arguments)}}(),J=function(){var e=Object(p.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.likes+=1,r(Object(l.a)(n)),e.next=4,E.update(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(e,t){g(e),B(t),setTimeout((function(){g(null)}),5e3)};return i?c.a.createElement("div",null,c.a.createElement("h2",null,"Blogs"),c.a.createElement(C,{message:d,type:x}),c.a.createElement(j,{user:i,blogs:n,logout:function(){window.localStorage.clear(),m()},setLike:J,removeBlog:R}),c.a.createElement(S,{buttonLabel:"Create new blog",ref:N},c.a.createElement(y,{createNew:I}))):c.a.createElement("div",null,c.a.createElement(C,{message:d,type:x}),c.a.createElement(w,{login:T,setNotification:M}))};o.a.render(c.a.createElement(B,null),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.ecfc69cd.chunk.js.map